{"version":3,"file":"index.min4.mjs","sources":["../node_modules/@aws-sdk/credential-provider-web-identity/dist-es/fromWebToken.js","../node_modules/@aws-sdk/credential-provider-web-identity/dist-es/fromTokenFile.js"],"sourcesContent":["export const fromWebToken = (init) => async (awsIdentityProperties) => {\n    init.logger?.debug(\"@aws-sdk/credential-provider-web-identity - fromWebToken\");\n    const { roleArn, roleSessionName, webIdentityToken, providerId, policyArns, policy, durationSeconds } = init;\n    let { roleAssumerWithWebIdentity } = init;\n    if (!roleAssumerWithWebIdentity) {\n        const { getDefaultRoleAssumerWithWebIdentity } = await import(\"@aws-sdk/nested-clients/sts\");\n        roleAssumerWithWebIdentity = getDefaultRoleAssumerWithWebIdentity({\n            ...init.clientConfig,\n            credentialProviderLogger: init.logger,\n            parentClientConfig: {\n                ...awsIdentityProperties?.callerClientConfig,\n                ...init.parentClientConfig,\n            },\n        }, init.clientPlugins);\n    }\n    return roleAssumerWithWebIdentity({\n        RoleArn: roleArn,\n        RoleSessionName: roleSessionName ?? `aws-sdk-js-session-${Date.now()}`,\n        WebIdentityToken: webIdentityToken,\n        ProviderId: providerId,\n        PolicyArns: policyArns,\n        Policy: policy,\n        DurationSeconds: durationSeconds,\n    });\n};\n","import { setCredentialFeature } from \"@aws-sdk/core/client\";\nimport { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { readFileSync } from \"fs\";\nimport { fromWebToken } from \"./fromWebToken\";\nconst ENV_TOKEN_FILE = \"AWS_WEB_IDENTITY_TOKEN_FILE\";\nconst ENV_ROLE_ARN = \"AWS_ROLE_ARN\";\nconst ENV_ROLE_SESSION_NAME = \"AWS_ROLE_SESSION_NAME\";\nexport const fromTokenFile = (init = {}) => async () => {\n    init.logger?.debug(\"@aws-sdk/credential-provider-web-identity - fromTokenFile\");\n    const webIdentityTokenFile = init?.webIdentityTokenFile ?? process.env[ENV_TOKEN_FILE];\n    const roleArn = init?.roleArn ?? process.env[ENV_ROLE_ARN];\n    const roleSessionName = init?.roleSessionName ?? process.env[ENV_ROLE_SESSION_NAME];\n    if (!webIdentityTokenFile || !roleArn) {\n        throw new CredentialsProviderError(\"Web identity configuration not specified\", {\n            logger: init.logger,\n        });\n    }\n    const credentials = await fromWebToken({\n        ...init,\n        webIdentityToken: readFileSync(webIdentityTokenFile, { encoding: \"ascii\" }),\n        roleArn,\n        roleSessionName,\n    })();\n    if (webIdentityTokenFile === process.env[ENV_TOKEN_FILE]) {\n        setCredentialFeature(credentials, \"CREDENTIALS_ENV_VARS_STS_WEB_ID_TOKEN\", \"h\");\n    }\n    return credentials;\n};\n"],"names":["fromWebToken","init","async","awsIdentityProperties","logger","debug","roleArn","roleSessionName","webIdentityToken","providerId","policyArns","policy","durationSeconds","roleAssumerWithWebIdentity","getDefaultRoleAssumerWithWebIdentity","import","clientConfig","credentialProviderLogger","parentClientConfig","callerClientConfig","clientPlugins","RoleArn","RoleSessionName","Date","now","WebIdentityToken","ProviderId","PolicyArns","Policy","DurationSeconds","ENV_TOKEN_FILE","fromTokenFile","webIdentityTokenFile","process","env","CredentialsProviderError","credentials","readFileSync","encoding","setCredentialFeature"],"mappings":"iQAAY,MAACA,EAAgBC,GAASC,MAAOC,IACzCF,EAAKG,QAAQC,MAAM,4DACnB,MAAMC,QAAEA,EAAOC,gBAAEA,EAAeC,iBAAEA,EAAgBC,WAAEA,EAAUC,WAAEA,EAAUC,OAAEA,EAAMC,gBAAEA,GAAoBX,EACxG,IAAIY,2BAAEA,GAA+BZ,EACrC,IAAKY,EAA4B,CAC7B,MAAMC,qCAAEA,SAA+CC,OAAO,oBAC9DF,EAA6BC,EAAqC,IAC3Db,EAAKe,aACRC,yBAA0BhB,EAAKG,OAC/Bc,mBAAoB,IACbf,GAAuBgB,sBACvBlB,EAAKiB,qBAEbjB,EAAKmB,cACX,CACD,OAAOP,EAA2B,CAC9BQ,QAASf,EACTgB,gBAAiBf,GAAmB,sBAAsBgB,KAAKC,QAC/DC,iBAAkBjB,EAClBkB,WAAYjB,EACZkB,WAAYjB,EACZkB,OAAQjB,EACRkB,gBAAiBjB,GACnB,ECnBAkB,EAAiB,8BAGVC,EAAgB,CAAC9B,EAAO,CAAA,IAAOC,UACxCD,EAAKG,QAAQC,MAAM,6DACnB,MAAM2B,EAAuB/B,GAAM+B,sBAAwBC,QAAQC,IAAIJ,GACjExB,EAAUL,GAAMK,SAAW2B,QAAQC,IAAgB,aACnD3B,EAAkBN,GAAMM,iBAAmB0B,QAAQC,IAAyB,sBAClF,IAAKF,IAAyB1B,EAC1B,MAAM,IAAI6B,EAAyB,2CAA4C,CAC3E/B,OAAQH,EAAKG,SAGrB,MAAMgC,QAAoBpC,EAAa,IAChCC,EACHO,iBAAkB6B,EAAaL,EAAsB,CAAEM,SAAU,UACjEhC,UACAC,mBAJsBP,GAS1B,OAHIgC,IAAyBC,QAAQC,IAAIJ,IACrCS,EAAqBH,EAAa,wCAAyC,KAExEA,CAAW"}